/*
	P_pointReflected.slim
	
	This exercises the Subpopulation method pointReflected()
*/

initialize() {
	initializeSLiMOptions(dimensionality="xy");
}
1 late() {
	sim.addSubpop("p1", 100);
	p1.setSpatialBounds(c(0, 0, 100, 100));
	points = runif(10000000 * 2, min=-20, max=120);
	
	x = p1.pointReflected(points);
	meanx = mean(x);
	//catn("mean coordinate: " + meanx);
	
	y = p1.pointReflected(points);
	
	for (i in 1:150) p1.pointReflected(points);
	
	// summarize results
	if (identical(x, y))
		catn("### ALL " + mean(x) + " (" + length(x) + ") ###");
	else
		catn("### *** INCONSISTENT *** " + mean(x) + ", " + mean(y) + " (" + length(x) + ") *** ###");
}
