/*
	T_CalculateAllStrengths2D.slim
	
	This exercises building the strengths sparse array, primarily, although
	it also builds the distances sparse array.  This is the 1D case.
*/

initialize() {
	initializeSLiMOptions(dimensionality="x");
	initializeMutationRate(0);
	initializeMutationType("m1", 0.5, "f", 0.0);
	initializeGenomicElementType("g1", m1, 1.0);
	initializeGenomicElement(g1, 0, 99999);
	initializeRecombinationRate(0);
	
	initializeInteractionType(1, "x", reciprocal=T, maxDistance=0.0008);
	i1.setInteractionFunction("n", 1.0, 0.00025);
}
1 late() {
	sim.addSubpop("p1", 1000000);
	
	inds = p1.individuals;
	inds.setSpatialPosition(p1.pointUniform(p1.individualCount));
	
	i1.evaluate(immediate=T);
}
